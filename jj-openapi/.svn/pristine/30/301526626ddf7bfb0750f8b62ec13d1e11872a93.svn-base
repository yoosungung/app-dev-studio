package kr.ac.jj.openapi.application.openapi.apilist.service;

import java.util.HashMap;
import java.util.List;
import java.util.Map;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Service;

import kr.ac.jj.openapi.application.openapi.apilist.mapper.ApiListMapper;
import kr.ac.jj.openapi.application.openapi.servicemanage.model.ServiceManageModel;
import kr.ac.jj.openapi.domain.main.model.api.svc.mapng.TbApiSvcMapng;

/**
 * api 리스트 Service
 */
@Service
public class ApiListServiceImpl {

    private @Autowired ApiListMapper apiListMapper;

    /**
     * api 테스트
     *
     * @param url
     * @param model
     * @return
     */
    public ServiceManageModel apiTest(String url, ServiceManageModel model) {
        List<TbApiSvcMapng> tbApiSvcMapngList = model.getTbApiSvcMapngList();

        Map<String, Object> apiInfo = new HashMap<String, Object>();

        for (TbApiSvcMapng tbApiSvcMapng : tbApiSvcMapngList) {
            apiInfo.put(tbApiSvcMapng.getVriabl(), tbApiSvcMapng.getInputVal());
        }

        model.setTestResult(apiListMapper.apiTest(url, apiInfo));

        return model;
    }

}
