<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<!--
 교양교과 핵심역량 Mapper
 -->
<mapper namespace="kr.ac.jj.dashboard.application.dashboard.supercompetence.mapper.SuperCompetenceMapper">

    <!-- 데이터 조회 -->
    <select id="readAvgData" resultType="kr.ac.jj.shared.infrastructure.framework.core.support.collection.CamelKeyMap">
        <![CDATA[
            SELECT ROUND(AVG(S_POINT),2) AS S_POINT
                   , ROUND(AVG(U_POINT),2) AS U_POINT
                   , ROUND(AVG(P_POINT),2) AS P_POINT
                   , ROUND(AVG(E_POINT),2) AS E_POINT
                   , ROUND(AVG(R_POINT),2) AS R_POINT
            FROM   DM_ON_SUPER
        ]]>
    </select>

    <select id="readAvgDaehakData" resultType="kr.ac.jj.shared.infrastructure.framework.core.support.collection.CamelKeyMap">
        <![CDATA[
            SELECT DAEHAK_NAME
                   , ROUND(AVG(S_POINT),2) AS S_POINT
                   , ROUND(AVG(U_POINT),2) AS U_POINT
                   , ROUND(AVG(P_POINT),2) AS P_POINT
                   , ROUND(AVG(E_POINT),2) AS E_POINT
                   , ROUND(AVG(R_POINT),2) AS R_POINT
            FROM   DM_ON_SUPER
            GROUP BY DAEHAK_NAME
        ]]>
    </select>

    <select id="readDaehakYearData" resultType="kr.ac.jj.shared.infrastructure.framework.core.support.collection.CamelKeyMap">
        <![CDATA[
            SELECT HAKG_YEAR
                   , ROUND(AVG(S_POINT),2) AS S_POINT
                   , ROUND(AVG(U_POINT),2) AS U_POINT
                   , ROUND(AVG(P_POINT),2) AS P_POINT
                   , ROUND(AVG(E_POINT),2) AS E_POINT
                   , ROUND(AVG(R_POINT),2) AS R_POINT
            FROM   DM_ON_SUPER
            WHERE DAEHAK_NAME = #{search.daehakName}
        ]]>
        <if test='search.hakgYear != null and search.hakgYear != ""'>
            <![CDATA[
                AND HAKG_YEAR = #{search.hakgYear}
            ]]>
        </if>
        <if test='search.hakbuName != null and search.hakbuName != ""'>
            <![CDATA[
                AND HAKBU_NAME = #{search.hakbuName}
            ]]>
        </if>
        <![CDATA[
            GROUP BY HAKG_YEAR
            ORDER BY HAKG_YEAR
        ]]>
    </select>

    <select id="readHakbuData" resultType="kr.ac.jj.shared.infrastructure.framework.core.support.collection.CamelKeyMap">
        <![CDATA[
            SELECT *
            FROM   DM_ON_SUPER
            WHERE  DAEHAK_NAME = #{search.daehakName}
        ]]>
        <if test='search.hakbuName != null and search.hakbuName != ""'>
            <![CDATA[
                AND HAKBU_NAME = #{search.hakbuName}
            ]]>
        </if>
        <if test='search.hakgYear != null and search.hakgYear != ""'>
            <![CDATA[
                AND HAKG_YEAR = #{search.hakgYear}
            ]]>
        </if>
        ORDER BY HAKG_YEAR
    </select>
</mapper>
