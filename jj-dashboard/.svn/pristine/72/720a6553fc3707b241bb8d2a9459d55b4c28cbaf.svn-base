/**
 * @param vue
 * @returns
 */
function DropOutViewService(vue) {
    /**
    * 목록 조회
    */
    this.readList = function() {
        CommonUtil.axios()
        .post("readList", vue.search)
        .then(function(response) {
            var data = response.data;

             //grid variables
            var tableColumnList = [];
            var tableDataList = [];
            var tableData = {};

            tableColumnList = [{header: "이름", name: "ipsyName", align: "center", width: "300", sortable: true },
                {header: "학번", name: "ipsyHakbun", align: "center", width: "300", sortable: true}];

            for(let i=0; i<data.length; i++) {
                tableDataList.push({"ipsyName": data[i].ipsyName, "ipsyHakbun": data[i].ipsyHakbun});
            }

            const Grid = tui.Grid
            $("#grid").html("");
            var grid = new Grid({
                el: document.getElementById('grid'),
                columnOptions: {minWidth: 100, resizable: true},
                columns: tableColumnList,
                data: tableDataList,
                bodyHeight: 700,
                theme: 'striped'
            });

            grid.on("click", function(event) {
                readStudent(grid.getRow(event.rowKey).ipsyHakbun);
            });
        })
        ["catch"](function(error) {
            CommonUtil.showAxiosError(error);
        });
    };
}

/**
 * 학생 조회
 */
var readStudent = function(hakbun) {
    CommonUtil.axios()
    .get("readStudent/" + hakbun)
    .then(function(response) {
        if (response != null) {
            vues.list.student= response.data;
            var student = response.data;

            var textColor = {
                ipsyPaper21: {color: ""},
                ipsyBongsaTime: {color: ""},
                ipsyPaperAve: {color: ""},
                ipsyHuboSeq: {color: ""},
                ipsyKumjung: {color: ""},
                ipsyHigh100: {color: ""},
                graduatedYy: {color: ""},
                ipsyGasanJumsu11: {color: ""},
                ipsyGasanJumsu23: {color: ""},
                ipsyGasanJumsu24: {color: ""},
                ipsyMeunjubAve: {color: ""},
                ipsyPaper11: {color: ""},
                ipsyJangIphak: {color: ""},
                ipsyTotalJumsu1: {color: ""},
                ipsyJangSuup: {color: ""}
            };

            if (student.ipsyPaper21 <= 19.7) {
                textColor.ipsyPaper21.color = "red";
            }
            if (student.ipsyBongsaTime >= 13.5) {
                textColor.ipsyBongsaTime.color = "red";
            }
            if (student.ipsyPaperAve >= 68.6 && student.ipsyPaperAve <= 80) {
                textColor.ipsyPaperAve.color = "red";
            }
            if (student.ipsyHuboSeq >= 15) {
                textColor.ipsyHuboSeq.color = "red";
            }
            if (student.ipsyKumjung >= 87) {
                textColor.ipsyKumjung.color = "red";
            }
            if (student.ipsyHigh100 >= 4.4) {
                textColor.ipsyHigh100.color = "red";
            }
            if (student.graduatedYy >= 7) {
                textColor.graduatedYy.color = "red";
            }
            if (student.ipsyGasanJumsu11 >= 702 && ipsyGasanJumsu11 <= 512) {
                textColor.ipsyGasanJumsu11.color = "red";
            }
            if (student.ipsyGasanJumsu23 >= 160) {
                textColor.ipsyGasanJumsu23.color = "red";
            }
            if (student.ipsyGasanJumsu24 >= 695) {
                textColor.ipsyGasanJumsu24.color = "red";
            }
            if (student.ipsyMeunjubAve >= 82) {
                textColor.ipsyMeunjubAve.color = "red";
            }
            if (student.ipsyPaper11 >= 28.5) {
                textColor.ipsyPaper11.color = "red";
            }
            if (student.ipsyJangIphak <= 57000) {
                textColor.ipsyJangIphak.color = "red";
            }
            if (student.ipsyTotalJumsu1 >= 930) {
                textColor.ipsyTotalJumsu1.color = "red";
            }
            if (student.ipsyJangSuup >= 3645000) {
                textColor.ipsyJangSuup.color = "red";
            }

            vues.list.textColor = textColor;
        }
    })
    ["catch"](function(error) {
        CommonUtil.showAxiosError(error);
    });
};

