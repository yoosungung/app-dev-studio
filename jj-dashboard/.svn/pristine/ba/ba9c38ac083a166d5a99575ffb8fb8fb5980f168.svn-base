package kr.ac.jj.dashboard.config;

import javax.annotation.PostConstruct;

import org.apache.ibatis.session.SqlSession;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.beans.factory.annotation.Qualifier;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;

import kr.ac.jj.shared.infrastructure.framework.core.support.codedata.CodeDataSourceAccessor;
import kr.ac.jj.shared.infrastructure.framework.mybatis.support.codedata.QueryCodeDataSource;

@Configuration
public class YgCodeDataConfig {

    private @Autowired CodeDataSourceAccessor codeDataSourceAccessor;

    @Qualifier(value = "sqlSession.yg")
    private @Autowired SqlSession sqlSession;

    @PostConstruct
    public void postConstruct() {
        codeDataSourceAccessor.addCodeDataSource(ygQueryCodeDataSource());
    }

    @Bean
    public QueryCodeDataSource ygQueryCodeDataSource() {
        QueryCodeDataSource codeDataSource = new QueryCodeDataSource(sqlSession);
        codeDataSource.addSqlMapperNamespacePrefix("yg-codedata.");

        return codeDataSource;
    }

}
